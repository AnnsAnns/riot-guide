---
title: api-pkg_tinyvcdiff.md
description: api-pkg_tinyvcdiff.md
---
# group `pkg_tinyvcdiff` 

Decoder for interleaved VCDIFF deltas.

Introductiontiny-vcdiff is a decoder for binary delta files that have been generated by [open-vcdiff](https://github.com/google/open-vcdiff) in the interleaved format.

UsageEvery delta requires a source (the known data) and a target (the reconstructed data). This implementation provides backends for the [Memory Technology Device](./doc/starlight-docs/src/content/docs/apidoc/api-undefined.md#group__drivers__mtd) and [Virtual File System (VFS) layer](./doc/starlight-docs/src/content/docs/apidoc/api-undefined.md#group__sys__vfs) storage drivers.

ExampleThe example down below uses a [Memory Technology Device](./doc/starlight-docs/src/content/docs/apidoc/api-undefined.md#group__drivers__mtd) device as known source data and writes the resulting target data into a [Virtual File System (VFS) layer](./doc/starlight-docs/src/content/docs/apidoc/api-undefined.md#group__sys__vfs) file.

```cpp
#include "vcdiff.h"
#include "[vcdiff_mtd.h](./doc/starlight-docs/src/content/docs/apidoc/api-undefined.md#vcdiff__mtd_8h)"
#include "[vcdiff_vfs.h](./doc/starlight-docs/src/content/docs/apidoc/api-undefined.md#vcdiff__vfs_8h)"

int apply_delta (const uint8_t *data, size_t data_len,
                 [mtd_dev_t](./doc/starlight-docs/src/content/docs/apidoc/api-drivers_mtd.md#structmtd__dev__t) *source_mtd,
                 int traget_fd)
{
    int rc;
    vcdiff_t vcdiff;
    vcdiff_init(&vcdiff);

    /* make sure source_mtd is already powered on */
    [vcdiff_mtd_t](./doc/starlight-docs/src/content/docs/apidoc/api-undefined.md#structvcdiff__mtd__t) source = [VCDIFF_MTD_INIT](./doc/starlight-docs/src/content/docs/apidoc/api-undefined.md#vcdiff__mtd_8h_1a8d9d7e05287eac5a8782c0c1d54607c7)(source_mtd);
    vcdiff_set_source_driver(&vcdiff, &[vcdiff_mtd_driver](./doc/starlight-docs/src/content/docs/apidoc/api-undefined.md#vcdiff__mtd_8h_1a1935c37655ec7f64c7ce9d0c51c92303), &source);

    /* make sure the vfs file is already opened for writing */
    [vcdiff_vfs_t](./doc/starlight-docs/src/content/docs/apidoc/api-undefined.md#structvcdiff__vfs__t) target = [VCDIFF_VFS_INIT](./doc/starlight-docs/src/content/docs/apidoc/api-undefined.md#vcdiff__vfs_8h_1ae2490a6bdffae10c09faf758dd1b9045)(fd_target);
    vcdiff_set_target_driver(&vcdiff, &[vcdiff_vfs_driver](./doc/starlight-docs/src/content/docs/apidoc/api-undefined.md#vcdiff__vfs_8h_1a69bbecd77051d6c24a1692cd892cac43), &target);

    rc = vcdiff_apply_delta(&vcdiff, data, data_len);
    if (rc != 0) {
        return rc;
    }

    rc = vcdiff_finish(&vcdiff);
    return rc;
}
```

LicenseLicensed under MIT.

**See also**: [https://github.com/jue89/tiny-vcdiff.git](https://github.com/jue89/tiny-vcdiff.git)

## Summary

 Members                        | Descriptions                                
--------------------------------|---------------------------------------------

